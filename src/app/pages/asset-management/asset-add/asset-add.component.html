
  <nav class="tabs-nav">
    <div class="tab-item" [class.active]="activeTabIndex === 0" (click)="switchTab(0)">基本資料</div>
    <div class="tab-item" [class.active]="activeTabIndex === 1" (click)="switchTab(1)">明細資料</div>
    <div class="tab-item" [class.active]="activeTabIndex === 2" (click)="switchTab(2)">財務資料</div>
  </nav>

<form [formGroup]="assetForm" (ngSubmit)="onSubmit()">
  <div class="tab-page" [class.active]="activeTabIndex === 0" id="tab-basic">
    <div class="tab-card">
      <div class="card-title">
        資產基本資料
        <div class="card-subtitle">填寫資產的基本資訊，包含編號、名稱、分類等</div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>資產編號
            <input type="text" formControlName="assetNumber" placeholder="將由系統自動生成" readonly class="readonly-field">
          </label>
          <div class="info-message">資產編號將在提交後由系統自動生成</div>
        </div>
        <div class="form-col">
          <label>資產名稱
            <input type="text" formControlName="assetName" placeholder="例如：Dell XPS 13 筆記型電腦">
          </label>
          <div *ngIf="assetForm.get('assetName')?.touched && assetForm.get('assetName')?.errors?.['required']" class="error-message">資產名稱為必填欄位</div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>資產大分類
            <select formControlName="assetCategory">
              <option value="">選擇大分類</option>
              <option *ngFor="let category of assetCategories" [value]="category.id">{{category.name}}</option>
            </select>
          </label>
          <div *ngIf="assetForm.get('assetCategory')?.touched && assetForm.get('assetCategory')?.errors?.['required']" class="error-message">資產大分類為必填欄位</div>
        </div>
        <div class="form-col">
          <label>資產中分類
            <select formControlName="assetSubCategory" [disabled]="selectedSubCategories.length === 0">
              <option value="">選擇中分類</option>
              <option *ngFor="let subCategory of selectedSubCategories" [value]="subCategory.id">{{subCategory.name}}</option>
            </select>
          </label>
        </div>
        <div class="form-col">
          <label>資產小分類
            <select formControlName="assetDetailCategory" [disabled]="selectedDetailCategories.length === 0">
              <option value="">選擇小分類</option>
              <option *ngFor="let detailCategory of selectedDetailCategories" [value]="detailCategory.id">{{detailCategory.name}}</option>
            </select>
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>資產來源
            <select formControlName="assetSource">
              <option value="">選擇來源</option>
              <option *ngFor="let source of assetSources" [value]="source.id">{{source.name}}</option>
            </select>
          </label>
          <div *ngIf="assetForm.get('assetSource')?.touched && assetForm.get('assetSource')?.errors?.['required']" class="error-message">資產來源為必填欄位</div>
        </div>
        <div class="form-col">
          <label>資產狀態
            <select formControlName="assetStatus">
              <option value="">選擇狀態</option>
              <option *ngFor="let status of assetStatuses" [value]="status.id">{{status.name}}</option>
            </select>
          </label>
          <div *ngIf="assetForm.get('assetStatus')?.touched && assetForm.get('assetStatus')?.errors?.['required']" class="error-message">資產狀態為必填欄位</div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col col-wide">
          <label>資產描述
            <textarea formControlName="assetDescription" placeholder="請輸入資產的詳細描述，例如規格、特性等"></textarea>
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>取得日期
            <div class="with-icon">
              <span class="icon-calendar"></span>
              <input type="date" formControlName="acquisitionDate" class="with-calendar">
            </div>
          </label>
        </div>
        <div class="form-col">
          <label>序號
            <input type="text" formControlName="serialNumber" placeholder="例如：XYZ123456789">
          </label>
        </div>
      </div>
      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="onCancel()">取消</button>
        <button type="button" class="btn-save" (click)="nextTab()">下一步</button>
      </div>
    </div>
  </div>

  <div class="tab-page" [class.active]="activeTabIndex === 1" id="tab-detail">
    <div class="tab-card">
      <div class="card-title">
        資產明細資料
        <div class="card-subtitle">設定資產的保管人、位置等明細資訊</div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>使用部門
            <select formControlName="department">
              <option value="">選擇部門</option>
              <option *ngFor="let dept of departments" [value]="dept.id">{{dept.name}}</option>
            </select>
          </label>
        </div>
        <div class="form-col">
          <label>保管人
            <select formControlName="custodian">
              <option value="">選擇保管人</option>
              <option *ngFor="let user of users" [value]="user.id">{{user.name}}</option>
            </select>
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>存放位置
            <select formControlName="location">
              <option value="">選擇位置</option>
              <option *ngFor="let loc of locations" [value]="loc.id">{{loc.name}}</option>
            </select>
          </label>
        </div>
        <div class="form-col">
          <label>詳細位置
            <input type="text" formControlName="detailLocation" placeholder="例如：3樓辦公室">
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>數量
            <input type="number" formControlName="quantity" min="1">
          </label>
          <div *ngIf="assetForm.get('quantity')?.touched && assetForm.get('quantity')?.errors?.['required']" class="error-message">數量為必填欄位</div>
          <div *ngIf="assetForm.get('quantity')?.touched && assetForm.get('quantity')?.errors?.['min']" class="error-message">數量必須大於等於1</div>
        </div>
      </div>
      <div class="form-row">
        <label class="form-label-title">附件上傳</label>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>資產照片
            <input type="file" (change)="handleFileUpload($event, 'assetPhoto')">
            <span class="file-desc">{{assetForm.get('assetPhoto')?.value || '未選擇任何檔案'}}</span>
          </label>
        </div>
        <div class="form-col">
          <label>相關文件
            <input type="file" (change)="handleFileUpload($event, 'relatedDocuments')">
            <span class="file-desc">{{assetForm.get('relatedDocuments')?.value || '未選擇任何檔案'}}</span>
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col col-wide">
          <label>備註
            <textarea formControlName="notes" placeholder="其他需說明的事項"></textarea>
          </label>
        </div>
      </div>
      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="prevTab()">上一步</button>
        <button type="button" class="btn-save" (click)="nextTab()">下一步</button>
      </div>
    </div>
  </div>

  <div class="tab-page" [class.active]="activeTabIndex === 2" id="tab-finance">
    <div class="tab-card">
      <div class="card-title">
        資產財務資料
        <div class="card-subtitle">設定資產的價值、折舊等財務相關資訊</div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>資產價值
            <input type="number" formControlName="assetValue" placeholder="NT$0">
          </label>
        </div>
        <div class="form-col">
          <label>預值
            <input type="number" formControlName="residualValue" placeholder="NT$0">
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>使用年限
            <select formControlName="usefulLife">
              <option [value]="3">3</option>
              <option [value]="5">5</option>
              <option [value]="7">7</option>
              <option [value]="10">10</option>
            </select>
          </label>
        </div>
        <div class="form-col">
          <label>折舊方法
            <select formControlName="depreciationMethod">
              <option value="">選擇折舊方法</option>
              <option *ngFor="let method of depreciationMethods" [value]="method.id">{{method.name}}</option>
            </select>
          </label>
        </div>
        <div class="form-col">
          <label>折舊開始日
            <div class="with-icon">
              <span class="icon-calendar"></span>
              <input type="date" formControlName="depreciationStartDate" class="with-calendar">
            </div>
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>供應商
            <input type="text" formControlName="supplier" placeholder="例如：廠商名稱">
          </label>
        </div>
        <div class="form-col">
          <label>採購單號
            <input type="text" formControlName="purchaseOrderNumber" placeholder="例如：PO-20230101">
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col">
          <label>保固期限
            <div class="with-icon">
              <span class="icon-calendar"></span>
              <input type="date" formControlName="warrantyPeriod" class="with-calendar">
            </div>
          </label>
        </div>
      </div>
      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="prevTab()">上一步</button>
        <button type="submit" class="btn-save">儲存資產</button>
      </div>
    </div>
  </div>

